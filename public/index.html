<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>T.D.F Mp3 Downloader - Powered by THUGKEED TECH</title>
<style>
  /* Reset */
  * {
    margin: 0; padding: 0; box-sizing: border-box;
    font-family: 'Courier New', Courier, monospace;
  }

  body {
    background: #0d0d0d;
    color: #0f0;
    overflow-x: hidden;
    min-height: 100vh;
    display: flex;
    justify-content: center;
    align-items: flex-start;
    padding: 2rem;
  }

  #root {
    width: 100%;
    max-width: 900px;
  }

  /* Glitch effect for title */
  h1 {
    position: relative;
    font-size: 3.5rem;
    text-transform: uppercase;
    text-align: center;
    margin-bottom: 2rem;
    color: #0f0;
    letter-spacing: 0.2rem;
    animation: flicker 2s infinite;
  }

  h1::before,
  h1::after {
    content: attr(data-text);
    position: absolute;
    left: 0; top: 0;
    width: 100%; height: 100%;
    opacity: 0.8;
    clip-path: polygon(0 0, 100% 0, 100% 45%, 0 45%);
  }
  h1::before {
    left: 2px;
    text-shadow: -2px 0 red;
    animation: glitch1 2s infinite;
  }
  h1::after {
    left: -2px;
    text-shadow: -2px 0 blue;
    animation: glitch2 2s infinite;
    clip-path: polygon(0 55%, 100% 55%, 100% 100%, 0 100%);
  }

  @keyframes flicker {
    0%, 19%, 21%, 23%, 25%, 54%, 56%, 100% {
      opacity: 1;
      text-shadow:
        0 0 5px #0f0,
        0 0 10px #0f0,
        0 0 20px #0f0,
        0 0 40px #0f0;
    }
    20%, 22%, 24%, 55% {
      opacity: 0.4;
      text-shadow: none;
    }
  }

  @keyframes glitch1 {
    0% {
      clip-path: polygon(0 2%, 100% 2%, 100% 15%, 0 15%);
      transform: translate(-2px, -2px);
    }
    50% {
      clip-path: polygon(0 10%, 100% 10%, 100% 20%, 0 20%);
      transform: translate(2px, 2px);
    }
    100% {
      clip-path: polygon(0 2%, 100% 2%, 100% 15%, 0 15%);
      transform: translate(-2px, -2px);
    }
  }
  @keyframes glitch2 {
    0% {
      clip-path: polygon(0 85%, 100% 85%, 100% 98%, 0 98%);
      transform: translate(2px, 2px);
    }
    50% {
      clip-path: polygon(0 75%, 100% 75%, 100% 85%, 0 85%);
      transform: translate(-2px, -2px);
    }
    100% {
      clip-path: polygon(0 85%, 100% 85%, 100% 98%, 0 98%);
      transform: translate(2px, 2px);
    }
  }

  /* Ads banners */
  .ad-banner {
    position: fixed;
    top: 20px;
    right: -300px;
    background: #111;
    border: 1px solid #0f0;
    padding: 1rem 1.5rem;
    font-weight: 700;
    color: #0f0;
    box-shadow: 0 0 10px #0f0;
    border-radius: 8px;
    width: 280px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    cursor: pointer;
    animation: slideIn 0.8s forwards;
    z-index: 9999;
  }
  .ad-banner.github {
    top: 70px;
    border-color: #ff3c00;
    color: #ff3c00;
    box-shadow: 0 0 15px #ff3c00;
  }
  .ad-button {
    background: transparent;
    border: 1px solid currentColor;
    color: inherit;
    padding: 0.3rem 0.7rem;
    border-radius: 5px;
    font-size: 0.9rem;
    text-decoration: none;
    transition: background 0.3s ease;
  }
  .ad-button:hover {
    background: currentColor;
    color: #000;
  }

  @keyframes slideIn {
    to {
      right: 20px;
    }
  }
  @keyframes slideOut {
    to {
      right: -300px;
    }
  }

  /* Content blur when ads active */
  #content.blur {
    filter: blur(1.5px);
    pointer-events: none;
  }

  /* Search */
  .search-container {
    display: flex;
    justify-content: center;
    margin-bottom: 2rem;
    gap: 1rem;
  }
  input[type=text] {
    background: #111;
    border: 1px solid #0f0;
    color: #0f0;
    padding: 0.6rem 1rem;
    font-size: 1.2rem;
    border-radius: 6px;
    width: 60%;
    transition: box-shadow 0.3s ease;
    outline: none;
  }
  input[type=text]:focus {
    box-shadow: 0 0 10px #0f0;
  }
  button {
    background: #0f0;
    border: none;
    padding: 0.65rem 1.5rem;
    font-weight: 700;
    font-size: 1.2rem;
    border-radius: 6px;
    cursor: pointer;
    color: #000;
    transition: background 0.3s ease, box-shadow 0.3s ease;
  }
  button:hover:not(:disabled) {
    background: #00ff00;
    box-shadow: 0 0 12px #0f0;
  }
  button:disabled {
    background: #054005;
    cursor: not-allowed;
  }

  /* Loader spinner */
  .loader {
    border: 6px solid #111;
    border-top: 6px solid #0f0;
    border-radius: 50%;
    width: 60px;
    height: 60px;
    margin: 2rem auto;
    animation: spin 1s linear infinite;
  }
  @keyframes spin {
    to {
      transform: rotate(360deg);
    }
  }

  /* Results grid */
  .results {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
    gap: 1.2rem;
  }

  /* Cards */
  .card {
    background: #111;
    border: 1px solid #0f0;
    border-radius: 10px;
    overflow: hidden;
    display: flex;
    flex-direction: column;
    cursor: pointer;
    transition: transform 0.3s ease, box-shadow 0.3s ease;
  }
  .card:hover {
    transform: translateY(-6px);
    box-shadow: 0 0 12px #0f0;
  }

  .thumbnail {
    background-position: center;
    background-size: cover;
    height: 140px;
  }

  .info {
    padding: 1rem;
    flex-grow: 1;
    display: flex;
    flex-direction: column;
  }

  .title {
    font-weight: 700;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
    color: #0f0;
    flex-grow: 1;
  }

  .channel {
    font-size: 0.9rem;
    color: #4caf50aa;
    margin-bottom: 1rem;
  }

  .btn-download {
    background: #ff3c00;
    border: none;
    color: #fff;
    font-weight: 700;
    padding: 0.5rem;
    border-radius: 6px;
    cursor: pointer;
    transition: background 0.3s ease;
  }
  .btn-download:hover {
    background: #ff5722;
  }

  /* Footer */
  .footer {
    text-align: center;
    margin-top: 3rem;
    font-size: 0.9rem;
    color: #0f0;
  }
  .footer a {
    color: #ff3c00;
    font-weight: 700;
    text-decoration: none;
  }
  .footer a:hover {
    text-decoration: underline;
  }

  /* Responsive */
  @media (max-width: 600px) {
    input[type=text] {
      width: 100%;
    }
    .search-container {
      flex-direction: column;
      gap: 1rem;
    }
  }
</style>
</head>
<body>
<div id="root"></div>

<!-- React + ReactDOM + Axios CDN -->
<script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
<script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
<script crossorigin src="https://unpkg.com/axios/dist/axios.min.js"></script>

<script>
  const { useState, useEffect } = React;

  function App() {
    const [search, setSearch] = useState('');
    const [results, setResults] = useState([]);
    const [loading, setLoading] = useState(false);
    const [error, setError] = useState(null);

    const [adStep, setAdStep] = useState(1);
    const [countdown, setCountdown] = useState(10);

    const API_KEY = 'AIzaSyAZBeFmCnDwcRhwhHxB9QjT1x4UqJhjGPU';
    const backendURL = ''; // Update after deploy!

    useEffect(() => {
      if (adStep === 0) return;
      if (countdown === 0) {
        if (adStep === 1) {
          setAdStep(2);
          setCountdown(10);
        } else {
          setAdStep(0);
        }
        return;
      }
      const timer = setTimeout(() => setCountdown(countdown - 1), 1000);
      return () => clearTimeout(timer);
    }, [countdown, adStep]);

    function extractVideoID(url) {
      const regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#&?]*).*/;
      const match = url.match(regExp);
      return (match && match[7].length === 11) ? match[7] : null;
    }

    function isYouTubeURL(str) {
      const ytRegex = /^(https?\:\/\/)?(www\.youtube\.com|youtu\.?be)\/.+$/;
      return ytRegex.test(str);
    }

    async function handleSearch() {
      if (adStep !== 0) return;
      setError(null);
      if (!search.trim()) {
        setError('Please enter a song name or YouTube URL');
        return;
      }
      setLoading(true);
      setResults([]);

      if (isYouTubeURL(search.trim())) {
        try {
          const videoId = extractVideoID(search.trim());
          if (!videoId) throw new Error('Invalid YouTube URL');

          const response = await axios.get(
            `https://www.googleapis.com/youtube/v3/videos?part=snippet&id=${videoId}&key=${API_KEY}`
          );
          if (response.data.items.length === 0) {
            setError('No video found with this URL');
            setLoading(false);
            return;
          }
          const item = response.data.items[0];
          setResults([{
            id: item.id,
            title: item.snippet.title,
            channel: item.snippet.channelTitle,
            thumbnail: item.snippet.thumbnails.high.url,
          }]);
        } catch {
          setError('Failed to fetch video info. Check your URL/API key.');
        }
      } else {
        try {
          const response = await axios.get(
            `https://www.googleapis.com/youtube/v3/search?part=snippet&type=video&maxResults=12&q=${encodeURIComponent(search)}&key=${API_KEY}`
          );
          const items = response.data.items.map((item) => ({
            id: item.id.videoId,
            title: item.snippet.title,
            channel: item.snippet.channelTitle,
            thumbnail: item.snippet.thumbnails.high.url,
          }));
          setResults(items);
        } catch {
          setError('Failed to search videos. Check your API key or quota.');
        }
      }
      setLoading(false);
    }

    function handleDownload(videoId) {
      if (!backendURL) {
        alert('Backend URL not configured! Please update backendURL in the code after deploy.');
        return;
      }
      const downloadURL = `${backendURL}/download?url=https://www.youtube.com/watch?v=${videoId}`;
      window.open(downloadURL, '_blank', 'noopener');
    }

    return (
      React.createElement('div', null,
        adStep === 1 && React.createElement('div', { className: 'ad-banner' },
          React.createElement('span', null, `Join our WhatsApp Channel! Ad ends in ${countdown}s`),
          React.createElement('a', {
            href: 'https://whatsapp.com/channel/0029VbB7a9v6LwHqDUERef0M',
            target: '_blank',
            rel: 'noopener noreferrer',
            className: 'ad-button',
            onClick: () => setAdStep(0)
          }, 'Join Now')
        ),

        adStep === 2 && React.createElement('div', { className: 'ad-banner github' },
          React.createElement('span', null, `Check out my GitHub repo! Ad ends in ${countdown}s`),
          React.createElement('a', {
            href: 'https://github.com/thugkeedxxx',
            target: '_blank',
            rel: 'noopener noreferrer',
            className: 'ad-button',
            onClick: () => setAdStep(0)
          }, 'Visit Repo')
        ),

        React.createElement('div', {
          id: 'content',
          className: adStep !== 0 ? 'blur' : ''
        },
          React.createElement('h1', { 'data-text': 'T.D.F Mp3 Downloader' }, 'T.D.F Mp3 Downloader'),

          React.createElement('div', { className: 'search-container' },
            React.createElement('input', {
              type: 'text',
              placeholder: 'Search any song or paste YouTube URL',
              value: search,
              onChange: e => setSearch(e.target.value),
              onKeyDown: e => { if (e.key === 'Enter') handleSearch(); },
              disabled: adStep !== 0
            }),
            React.createElement('button', { onClick: handleSearch, disabled: adStep !== 0 }, 'Search')
          ),

          error && React.createElement('p', { style: { color: '#ff5a5a', marginTop: '1rem' } }, error),

          loading ? React.createElement('div', { className: 'loader' }) :
            React.createElement('div', { className: 'results' },
              results.map(item =>
                React.createElement('div', { key: item.id, className: 'card' },
                  React.createElement('div', { className: 'thumbnail', style: { backgroundImage: `url(${item.thumbnail})` } }),
                  React.createElement('div', { className: 'info' },
                    React.createElement('div', { className: 'title' }, item.title),
                    React.createElement('div', { className: 'channel' }, item.channel),
                    React.createElement('button', {
                      className: 'btn-download',
                      onClick: () => handleDownload(item.id)
                    }, 'Download MP3')
                  )
                )
              )
            ),

          React.createElement('div', { className: 'footer' },
            'Powered by ',
            React.createElement('a', {
              href: 'https://github.com/thugkeedxxx',
              target: '_blank',
              rel: 'noopener noreferrer',
              style: { color: '#ff3c00', fontWeight: 'bold', textDecoration: 'none' }
            }, 'THUGKEED TECH')
          )
        )
      )
    );
  }

  ReactDOM.createRoot(document.getElementById('root')).render(React.createElement(App));
</script>
</body>
</html>
